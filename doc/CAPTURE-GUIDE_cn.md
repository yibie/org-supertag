# Org-Supertag æ•è·ç³»ç»Ÿ

## ğŸš€ ä»€ä¹ˆæ˜¯æ•è·ç³»ç»Ÿï¼Ÿ

Org-Supertag æ•è·ç³»ç»Ÿæä¾›äº†ä¸€ä¸ªå¼ºå¤§è€Œçµæ´»çš„èŠ‚ç‚¹åˆ›å»ºæœºåˆ¶ï¼Œæ”¯æŒåŠ¨æ€æ¨¡æ¿ã€å†…å®¹ç”Ÿæˆå™¨å’Œè‡ªåŠ¨å­—æ®µå¡«å……ã€‚è¯¥ç³»ç»Ÿéµå¾ªæ•°æ®åˆ†ç¦»åŸåˆ™ï¼Œå°†èŠ‚ç‚¹å†…å®¹ä¸æ‰©å±•å±æ€§åˆ†åˆ«å­˜å‚¨åœ¨ Org æ–‡ä»¶å’Œæ•°æ®åº“ä¸­ã€‚

### ğŸ¯ æ ¸å¿ƒç†å¿µ

ä¼ ç»Ÿ Org-mode ä¸­ï¼Œåˆ›å»ºèŠ‚ç‚¹éœ€è¦æ‰‹åŠ¨è¾“å…¥æ ‡é¢˜ã€æ ‡ç­¾å’Œå±æ€§ã€‚åœ¨ Org-Supertag æ•è·ç³»ç»Ÿä¸­ï¼š

- ğŸ”„ **æ¨¡æ¿é©±åŠ¨** - ä½¿ç”¨é¢„å®šä¹‰æ¨¡æ¿å¿«é€Ÿåˆ›å»ºç»“æ„åŒ–èŠ‚ç‚¹
- ğŸ§  **æ™ºèƒ½å¡«å……** - è‡ªåŠ¨ä»å‰ªè´´æ¿ã€é€‰åŒºæˆ–å‡½æ•°è·å–å†…å®¹
- ğŸ·ï¸ **æ ‡ç­¾æ™ºèƒ½** - äº¤äº’å¼æ ‡ç­¾é€‰æ‹©å’Œè‡ªåŠ¨å®Œæˆ
- ğŸ“ **å­—æ®µä¸°å¯Œ** - è‡ªåŠ¨è®¾ç½®æ ‡ç­¾å­—æ®µå€¼

### âš¡ å¿«é€Ÿä½“éªŒ

```org
;; ä½¿ç”¨æ¨¡æ¿å¿«é€Ÿåˆ›å»ºä»»åŠ¡èŠ‚ç‚¹
M-x supertag-capture-with-template RET t RET

;; ç»“æœè‡ªåŠ¨ç”Ÿæˆ:
* ä¿®å¤ç™»å½•é¡µé¢bug #task
  :PROPERTIES:
  :ID: a1b2c3d4-e5f6-7890-g1h2-i3j4k5l6m7n8
  :END:

  åˆ›å»ºæ—¶é—´: 2025-09-06
  çŠ¶æ€: å¾…å¼€å§‹
```

## ğŸ“– ä½¿ç”¨æŒ‡å—

### æ€»è§ˆï¼šä¸‰ç§å…¸å‹å·¥ä½œæµ

- **åŸºäº org-capture çš„æ•è·**ï¼ˆ`org-capture` + Supertagï¼‰ï¼šå¤ç”¨ç°æœ‰ `org-capture-templates`ï¼Œç”± Supertag æ¥ç®¡ IDã€æ•°æ®åº“ã€å­—æ®µã€ç§»åŠ¨å’Œæ ‡ç­¾ã€‚
- **æ¨¡æ¿æ•è·**ï¼ˆ`supertag-capture-with-template`ï¼‰ï¼šä½¿ç”¨ DSL + åŠ¨æ€ç”Ÿæˆå™¨ + å­—æ®µè§„èŒƒçš„é«˜çº§æ•è·ã€‚
- **ç‹¬ç«‹æ•è·**ï¼ˆ`supertag-capture`ï¼‰ï¼šä¸€æ¬¡æ€§ã€è½»é‡çº§åˆ›å»ºèŠ‚ç‚¹ã€‚

åº•å±‚ç”±ä¸€ä¸ªç»Ÿä¸€çš„â€œæœ€ç»ˆå®šç¨¿ APIâ€è´Ÿè´£ï¼šæŠŠå½“å‰ Org æ ‡é¢˜è½¬æ¢ä¸º Supertag èŠ‚ç‚¹ï¼Œå¹¶æŒ‰ Tag/Field/Value æ¨¡å‹å†™å…¥å­—æ®µã€‚

### åŸºäº org-capture çš„æ•è·ï¼ˆæ¨èç»™å·²æœ‰ org-capture ç”¨æˆ·ï¼‰

å¦‚æœä½ å·²ç»åœ¨æ—¥å¸¸ä½¿ç”¨ org-captureï¼Œè¿™æ¡è·¯çº¿æ˜¯æœ€è‡ªç„¶çš„ï¼š

1. å¯ç”¨ Supertag ä¸ org-capture çš„é›†æˆï¼š
   ```elisp
   (setq supertag-org-capture-auto-enable t)
   ;; æˆ–ï¼š
   ;; (supertag-enable-org-capture-integration)
   ```
2. åœ¨ä½ çš„ org-capture æ¨¡æ¿ä¸Šæ·»åŠ  `:supertag` ä»¥åŠå¯é€‰æ‰©å±•ï¼š
   ```elisp
   (add-to-list 'org-capture-templates
                '("t" "å¸¦ Supertag çš„ä»»åŠ¡" entry
                  (file+headline "~/org/tasks.org" "Inbox")
                  "* TODO %^{ä»»åŠ¡}\n  %?\n"
                  :supertag t
                  :supertag-tags-prompt t
                  :supertag-template ((:tag "task" :field "status" :value "todo"))
                  :supertag-move 'link))  ;; æ•è·åç§»åŠ¨å¹¶åœ¨åŸä½ç½®ç•™é“¾æ¥
   ```

æ•´ä½“æµç¨‹ï¼š

- org-capture æŒ‰æ¨¡æ¿æ’å…¥æ ‡é¢˜å’Œæ­£æ–‡ï¼›
- Supertag å¯¹è¯¥èŠ‚ç‚¹åšâ€œæœ€ç»ˆå®šç¨¿â€ï¼šç¡®ä¿ `ID`ã€åŒæ­¥æ•°æ®åº“ã€å†™å…¥å­—æ®µï¼ˆ`:supertag-template`ï¼‰ï¼›
- å¦‚æœè®¾ç½®äº† `:supertag-tags-prompt t`ï¼š
  - ä¼šå¼¹å‡ºä¸€ä¸ªåŸºäº Supertag æ ‡ç­¾åº“çš„è¡¥å…¨ç•Œé¢ï¼Œå¯ä»å·²æœ‰æ ‡ç­¾ä¸­é€‰æ‹©ï¼Œæˆ–è¾“å…¥æ–°æ ‡ç­¾ï¼ˆè‡ªåŠ¨åˆ›å»ºä¸ºæ­£å¼ Supertag æ ‡ç­¾ï¼‰ï¼›
- å¦‚æœè®¾ç½®äº† `:supertag-move`ï¼Œåˆ™åœ¨å®šç¨¿åè§¦å‘ Supertag çš„ç§»åŠ¨é€»è¾‘ï¼š
  - `:supertag-move t` / `node` â†’ è°ƒç”¨ `supertag-move-node`ï¼Œäº¤äº’å¼é€‰æ‹©â€œæ–‡ä»¶ + ä½ç½®â€ï¼›
  - `:supertag-move link` / `:link` â†’ è°ƒç”¨ `supertag-move-node-and-link`ï¼Œç§»åŠ¨å¹¶åœ¨åŸå¤„ç•™é“¾æ¥ï¼›
  - `:supertag-move within-target` / `:within-target` â†’ åªåœ¨ **å½“å‰ capture ç›®æ ‡æ–‡ä»¶å†…éƒ¨**é€‰æ‹©æ’å…¥ä½ç½®ï¼ˆè·³è¿‡æ–‡ä»¶é€‰æ‹©å¯¹è¯æ¡†ï¼‰ã€‚

### ä¸¤ç§å†…ç½®æ•è·æ–¹å¼

#### 1. ç‹¬ç«‹æ•è· (`supertag-capture`)

æœ€ç®€å•çš„èŠ‚ç‚¹åˆ›å»ºæ–¹å¼ï¼Œé€‚åˆä¸´æ—¶æˆ–ä¸€æ¬¡æ€§èŠ‚ç‚¹åˆ›å»ºã€‚

```
M-x supertag-capture
```

**æ“ä½œæµç¨‹**:

1. è¾“å…¥èŠ‚ç‚¹æ ‡é¢˜
2. é€‰æ‹©æ ‡ç­¾ï¼ˆå¯é€‰ï¼Œæ”¯æŒå¤šé€‰ï¼‰
3. é€‰æ‹©ç›®æ ‡æ–‡ä»¶å’Œæ’å…¥ä½ç½®
4. ç³»ç»Ÿåˆ›å»ºå¸¦æœ‰IDçš„OrgèŠ‚ç‚¹
5. å¯é€‰æ‹©è¿›è¡Œå­—æ®µå€¼ä¸°å¯Œ

**é€‚ç”¨åœºæ™¯**ï¼š

- ä¸´æ—¶æƒ³æ³•è®°å½•
- ç®€å•ä»»åŠ¡åˆ›å»º
- å¿«é€Ÿå†…å®¹æ•è·

#### 2. æ¨¡æ¿é©±åŠ¨æ•è· (`supertag-capture-with-template`)

ä½¿ç”¨é¢„å®šä¹‰æ¨¡æ¿å¿«é€Ÿåˆ›å»ºç»“æ„åŒ–èŠ‚ç‚¹ï¼Œé€‚åˆé‡å¤æ€§å·¥ä½œæµç¨‹ã€‚

```
M-x supertag-capture-with-template
```

**æ“ä½œæµç¨‹**:

1. é€‰æ‹©å·²é…ç½®çš„æ¨¡æ¿
2. æ ¹æ®æ¨¡æ¿è§„èŒƒæä¾›å†…å®¹
3. ç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆå®Œæ•´èŠ‚ç‚¹
4. å¯é€‰æ‹©è¿›è¡Œé¢å¤–å­—æ®µä¸°å¯Œ

**é€‚ç”¨åœºæ™¯**ï¼š

- æ ‡å‡†åŒ–æ–‡æ¡£åˆ›å»º
- é‡å¤æ€§ä»»åŠ¡è®°å½•
- ç»“æ„åŒ–ä¿¡æ¯æ”¶é›†

## ğŸ¨ æ¨¡æ¿ç³»ç»Ÿ

### æ¨¡æ¿é…ç½®ç»“æ„

```elisp
(setq supertag-capture-templates
      '((æ¨¡æ¿é”® "æ¨¡æ¿æè¿°"
         :file "ç›®æ ‡æ–‡ä»¶è·¯å¾„"  ; å¯é€‰ï¼šå¦‚æœçœç•¥ï¼Œç”¨æˆ·é€‰æ‹©ç›®æ ‡æ–‡ä»¶
         :node-spec
         ((èŠ‚ç‚¹è§„èŒƒåˆ—è¡¨...)))))
```

### èŠ‚ç‚¹è§„èŒƒè¯¦è§£

æ¯ä¸ªèŠ‚ç‚¹è§„èŒƒé¡¹ç›®åŒ…å«ä¸¤ä¸ªæ ¸å¿ƒéƒ¨åˆ†ï¼š

| å‚æ•°    | ç±»å‹ | å¿…éœ€ | æè¿°                                                 |
| ------- | ---- | ---- | ---------------------------------------------------- |
| `:part` | ç¬¦å· | æ˜¯   | èŠ‚ç‚¹éƒ¨åˆ†ç±»å‹ (`:title`, `:tags`, `:body`, `:fields`) |
| `:get`  | åˆ—è¡¨ | æ˜¯   | å†…å®¹ç”Ÿæˆè§„èŒƒ                                         |

### å†…å®¹ç”Ÿæˆå™¨

å†…å®¹ç”Ÿæˆå™¨å†³å®šäº†å¦‚ä½•ä¸ºèŠ‚ç‚¹çš„å„ä¸ªéƒ¨åˆ†å¡«å……å†…å®¹ã€‚

#### é™æ€å€¼ç”Ÿæˆå™¨ `:static`

ç›´æ¥ä½¿ç”¨æŒ‡å®šçš„å€¼ï¼Œä¸éœ€è¦ç”¨æˆ·è¾“å…¥ã€‚

```elisp
;; ç¤ºä¾‹ï¼šå›ºå®šæ ‡ç­¾
(:part :tags :get (:static ("å·¥ä½œ" "é‡è¦")))

;; ç¤ºä¾‹ï¼šå›ºå®šå­—æ®µå€¼
(:part :fields :get (:static (((:tag "é¡¹ç›®" :field "çŠ¶æ€" :value "è¿›è¡Œä¸­")))))
```

#### äº¤äº’å¼æç¤ºç”Ÿæˆå™¨ `:prompt`

æç¤ºç”¨æˆ·è¾“å…¥å†…å®¹ï¼Œå¯è®¾ç½®é»˜è®¤å€¼ã€‚

```elisp
;; ç¤ºä¾‹ï¼šè¾“å…¥æ ‡é¢˜
(:part :title :get (:prompt "ä»»åŠ¡æ ‡é¢˜: "))

;; ç¤ºä¾‹ï¼šè¾“å…¥æ ‡ç­¾ï¼ˆå¸¦é»˜è®¤å€¼ï¼‰
(:part :tags :get (:prompt "æ ‡ç­¾: " :initial-input "ä»»åŠ¡,"))

;; ç¤ºä¾‹ï¼šè¾“å…¥å­—æ®µå€¼
(:part :fields :get (:static (((:tag "ä»»åŠ¡" :field "ä¼˜å…ˆçº§" :get (:prompt "ä¼˜å…ˆçº§: "))))))
```

#### å‰ªè´´æ¿å†…å®¹ç”Ÿæˆå™¨ `:clipboard`

ä½¿ç”¨å½“å‰å‰ªè´´æ¿å†…å®¹ä½œä¸ºèŠ‚ç‚¹æ­£æ–‡ã€‚

```elisp
(:part :body :get (:clipboard))
```

#### é€‰åŒºå†…å®¹ç”Ÿæˆå™¨ `:region`

ä½¿ç”¨å½“å‰é€‰ä¸­çš„æ–‡æœ¬ä½œä¸ºå†…å®¹ã€‚å¦‚æœæ²¡æœ‰é€‰åŒºåˆ™æŠ¥é”™ã€‚

```elisp
(:part :body :get (:region))
```

#### é€‰åŒºæˆ–å‰ªè´´æ¿ç”Ÿæˆå™¨ `:region-or-clipboard`

ä¼˜å…ˆä½¿ç”¨é€‰åŒºï¼Œå¦‚æœæ²¡æœ‰é€‰åŒºåˆ™ä½¿ç”¨å‰ªè´´æ¿ã€‚

```elisp
(:part :body :get (:region-or-clipboard))
```

#### æ¨¡æ¿å­—ç¬¦ä¸²ç”Ÿæˆå™¨ `:template-string`

ä½¿ç”¨æ¨¡æ¿å­—ç¬¦ä¸²ç”Ÿæˆå†…å®¹ï¼Œæ”¯æŒå ä½ç¬¦æ›¿æ¢ã€‚

```elisp
(:part :body :get (:template-string "åˆ›å»ºæ—¥æœŸ: %date\nå†…å®¹: %clipboard\nçŠ¶æ€: å¾…å¤„ç†"))
```

**æ”¯æŒçš„å ä½ç¬¦**:

##### â° æ—¶é—´ç›¸å…³å ä½ç¬¦

| å ä½ç¬¦       | æè¿°       | ç¤ºä¾‹è¾“å‡º            |
| ------------ | ---------- | ------------------- |
| `%date`      | å½“å‰æ—¥æœŸ   | 2025-09-06          |
| `%time`      | å½“å‰æ—¶é—´   | 14:30               |
| `%datetime`  | æ—¥æœŸæ—¶é—´   | 2025-09-06 14:30    |
| `%timestamp` | å®Œæ•´æ—¶é—´æˆ³ | 2025-09-06 14:30:45 |
| `%week`      | å½“å‰å‘¨æ•°   | W36                 |
| `%month`     | å½“å‰æœˆä»½   | September           |
| `%year`      | å½“å‰å¹´ä»½   | 2025                |

##### ğŸ‘¤ ç”¨æˆ·ä¿¡æ¯å ä½ç¬¦

| å ä½ç¬¦      | æè¿°       | ç¤ºä¾‹è¾“å‡º    |
| ----------- | ---------- | ----------- |
| `%user`     | ç”¨æˆ·ç™»å½•å | chenyibin   |
| `%fullname` | ç”¨æˆ·å…¨å   | Chen Yibin  |
| `%hostname` | ç³»ç»Ÿä¸»æœºå | MacBook-Pro |

##### ğŸ“ æ–‡ä»¶ä¸Šä¸‹æ–‡å ä½ç¬¦

| å ä½ç¬¦       | æè¿°               | ç¤ºä¾‹è¾“å‡º                    |
| ------------ | ------------------ | --------------------------- |
| `%filename`  | å½“å‰ç¼“å†²åŒºæ–‡ä»¶å   | project.org                 |
| `%filepath`  | å½“å‰ç¼“å†²åŒºå®Œæ•´è·¯å¾„ | /Users/user/org/project.org |
| `%directory` | å½“å‰ç¼“å†²åŒºç›®å½•     | /Users/user/org/            |

##### ğŸ”— èŠ‚ç‚¹ä¸Šä¸‹æ–‡å ä½ç¬¦

| å ä½ç¬¦                | æè¿°             | ç¤ºä¾‹è¾“å‡º           |
| --------------------- | ---------------- | ------------------ |
| `%current-node-title` | å½“å‰èŠ‚ç‚¹æ ‡é¢˜     | é¡¹ç›®ç®¡ç†ç³»ç»Ÿ       |
| `%current-node-id`    | å½“å‰èŠ‚ç‚¹ID       | a1b2c3d4-e5f6-7890 |
| `%current-tags`       | å½“å‰èŠ‚ç‚¹æ ‡ç­¾åˆ—è¡¨ | é¡¹ç›®, é‡è¦         |

##### ğŸ› ï¸ å·¥å…·å ä½ç¬¦

| å ä½ç¬¦       | æè¿°         | ç¤ºä¾‹è¾“å‡º           |
| ------------ | ------------ | ------------------ |
| `%clipboard` | å‰ªè´´æ¿å†…å®¹   | [å‰ªè´´æ¿ä¸­çš„æ–‡æœ¬]   |
| `%random`    | éšæœº4ä½æ•°å­—  | 1234               |
| `%uuid`      | æ–°ç”Ÿæˆçš„UUID | f47ac10b-58cc-4372 |

ç¤ºä¾‹ç”¨æ³•ï¼š

```elisp
;; åˆ›å»ºåŒ…å«å¤šç§ä¿¡æ¯çš„æ¨¡æ¿
(:part :body :get (:template-string "æŠ¥å‘Šæ—¥æœŸ: %date\næŠ¥å‘Šäºº: %fullname\nä¸»æœºå: %hostname\nå†…å®¹:\n%clipboard"))
```

#### è‡ªå®šä¹‰å‡½æ•°ç”Ÿæˆå™¨ `:function`

è°ƒç”¨è‡ªå®šä¹‰å‡½æ•°ç”Ÿæˆå†…å®¹ã€‚

```elisp
(:part :body :get (:function my-custom-content-generator))
```

### å­—æ®µè®¾ç½®è§„èŒƒ

å­—æ®µè§„èŒƒç”¨äºä¸ºèŠ‚ç‚¹è‡ªåŠ¨è®¾ç½®æ ‡ç­¾å­—æ®µå€¼ã€‚

```elisp
(:part :fields :get (:static (((:tag "é¡¹ç›®" :field "çŠ¶æ€" :value "è¿›è¡Œä¸­")
                               (:tag "é¡¹ç›®" :field "ä¼˜å…ˆçº§" :value "é«˜")))))
```

å­—æ®µè§„èŒƒæ ¼å¼ï¼š

- `:tag` - æ ‡ç­¾ID
- `:field` - å­—æ®µåç§°
- `:value` - å­—æ®µå€¼ï¼ˆé™æ€ï¼‰
- `:get` - å­—æ®µå€¼ç”Ÿæˆå™¨ï¼ˆåŠ¨æ€ï¼‰

## ğŸ“‹ ä½¿ç”¨åœºæ™¯ä¸æ¨¡æ¿ç¤ºä¾‹

### æ—¥å¸¸ä»»åŠ¡åˆ›å»º

```elisp
;; æ¨¡æ¿é…ç½®
("t" "å¿«é€Ÿä»»åŠ¡"
 :file "~/org/tasks.org"
 :node-spec
 ((:part :title :get (:prompt "ä»»åŠ¡: "))
  (:part :tags  :get (:static ("ä»»åŠ¡")))
  (:part :body  :get (:template-string "åˆ›å»º: %date\nçŠ¶æ€: å¾…å¼€å§‹\n"))))
```

ä½¿ç”¨æ–¹æ³•:

1. `M-x supertag-capture-with-template RET t RET`
2. è¾“å…¥ä»»åŠ¡åç§°: "ä¿®å¤ç™»å½•é¡µé¢bug"
3. ç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆç»“æ„åŒ–ä»»åŠ¡èŠ‚ç‚¹

### å­¦ä¹ ç¬”è®°æ•è·

```elisp
;; æ¨¡æ¿é…ç½®
("l" "å­¦ä¹ ç¬”è®°"
 :file "~/org/learning.org"
 :node-spec
 ((:part :title :get (:prompt "å­¦ä¹ ä¸»é¢˜: "))
  (:part :tags  :get (:prompt "æ ‡ç­¾: " :initial-input "å­¦ä¹ ,"))
  (:part :body  :get (:region-or-clipboard))
  (:part :fields :get (:static (((:tag "å­¦ä¹ " :field "éš¾åº¦" :get (:prompt "éš¾åº¦(1-5): "))
                                 (:tag "å­¦ä¹ " :field "æ¥æº" :get (:prompt "å­¦ä¹ æ¥æº: "))))))))
```

ä½¿ç”¨æ–¹æ³•:

1. å¤åˆ¶ä¸€æ®µå­¦ä¹ èµ„æ–™åˆ°å‰ªè´´æ¿
2. `M-x supertag-capture-with-template RET l RET`
3. è¾“å…¥å­¦ä¹ ä¸»é¢˜å’Œç›¸å…³ä¿¡æ¯
4. ç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆå­¦ä¹ ç¬”è®°èŠ‚ç‚¹

### ä¼šè®®è®°å½•æ¨¡æ¿

```elisp
;; æ¨¡æ¿é…ç½®
("m" "ä¼šè®®è®°å½•"
 :file "~/org/meetings.org"
 :node-spec
 ((:part :title :get (:prompt "ä¼šè®®ä¸»é¢˜: "))
  (:part :tags  :get (:static ("ä¼šè®®")))
  (:part :body  :get (:template-string "æ—¶é—´: %date\nå‚ä¸è€…: \n\nè®®ç¨‹:\n\nè®¨è®ºè¦ç‚¹:\n\nè¡ŒåŠ¨é¡¹:\n"))
  (:part :fields :get (:static (((:tag "ä¼šè®®" :field "ç±»å‹" :get (:prompt "ä¼šè®®ç±»å‹: "))
                                 (:tag "ä¼šè®®" :field "çŠ¶æ€" :value "å·²å®Œæˆ")))))))
```

### é¡¹ç›®è§„åˆ’æ¨¡æ¿

```elisp
("p" "é¡¹ç›®è§„åˆ’"
 :file "~/org/projects.org"
 :node-spec
 ((:part :title :get (:prompt "é¡¹ç›®åç§°: "))
  (:part :tags  :get (:static ("é¡¹ç›®" "è§„åˆ’")))
  (:part :body  :get (:template-string "å¼€å§‹æ—¥æœŸ: %date\n\nç›®æ ‡:\n\né‡Œç¨‹ç¢‘:\n\nèµ„æºéœ€æ±‚:\n"))
  (:part :fields :get (:static (((:tag "é¡¹ç›®" :field "çŠ¶æ€" :value "è§„åˆ’ä¸­")
                                 (:tag "é¡¹ç›®" :field "è´Ÿè´£äºº" :get (:prompt "è´Ÿè´£äºº: "))))))))
```

### çµæ„Ÿæ•è·æ¨¡æ¿

```elisp
("i" "çµæ„Ÿæƒ³æ³•"
 :file "~/org/ideas.org"
 :node-spec
 ((:part :title :get (:prompt "æƒ³æ³•æ ‡é¢˜: "))
  (:part :tags  :get (:prompt "åˆ†ç±»æ ‡ç­¾: " :initial-input "æƒ³æ³•,"))
  (:part :body  :get (:template-string "è®°å½•æ—¶é—´: %date\n\nè¯¦ç»†æè¿°:\n%clipboard\n\nç›¸å…³æ€è€ƒ:\n"))))
```

## âš™ï¸ é«˜çº§åŠŸèƒ½

### å­—æ®µè‡ªåŠ¨å¡«å……

æ¨¡æ¿å¯ä»¥è‡ªåŠ¨ä¸ºèŠ‚ç‚¹è®¾ç½®å­—æ®µå€¼ï¼Œæ”¯æŒé™æ€å€¼å’ŒåŠ¨æ€ç”Ÿæˆï¼š

```elisp
(:part :fields :get (:static (((:tag "é¡¹ç›®" :field "çŠ¶æ€" :value "è¿›è¡Œä¸­")
                               (:tag "é¡¹ç›®" :field "åˆ›å»ºè€…" :get (:function user-full-name))
                               (:tag "é¡¹ç›®" :field "æˆªæ­¢æ—¥æœŸ" :get (:prompt "æˆªæ­¢æ—¥æœŸ: "))))))
```

### äº¤äº’å¼å­—æ®µä¸°å¯Œ

æ•è·å®Œæˆåï¼Œç”¨æˆ·å¯ä»¥ç»§ç»­æ·»åŠ å­—æ®µå€¼ï¼š

1. ç³»ç»Ÿæç¤ºæ˜¯å¦è¦ä¸°å¯ŒèŠ‚ç‚¹
2. ç”¨æˆ·é€‰æ‹©èŠ‚ç‚¹ä¸Šçš„æ ‡ç­¾
3. é€‰æ‹©è¯¥æ ‡ç­¾çš„å¯ç”¨å­—æ®µ
4. è¾“å…¥å­—æ®µå€¼
5. é‡å¤ç›´åˆ°å®Œæˆ

### æ™ºèƒ½ä½ç½®é€‰æ‹©

æä¾›å››ç§æ’å…¥é€‰é¡¹ï¼š

- **æ–‡ä»¶é¡¶éƒ¨**: åœ¨æ–‡ä»¶å¼€å§‹å¤„æ’å…¥
- **æ–‡ä»¶æœ«å°¾**: åœ¨æ–‡ä»¶ç»“å°¾æ’å…¥
- **æ ‡é¢˜ä¸‹æ–¹**: ä½œä¸ºé€‰å®šæ ‡é¢˜çš„å­é¡¹ç›®
- **æ ‡é¢˜ä¹‹å**: ä¸é€‰å®šæ ‡é¢˜åŒçº§

## ğŸ”§ é…ç½®ä¸æ‰©å±•

### åŸºç¡€é…ç½®

```elisp
;; è®¾ç½®æ•è·æ¨¡æ¿
(setq supertag-capture-templates
      '(
        ;; å¿«é€Ÿä»»åŠ¡
        ("t" "å¿«é€Ÿä»»åŠ¡"
         :file "~/org/tasks.org"
         :node-spec
         ((:part :title :get (:prompt "ä»»åŠ¡: "))
          (:part :tags  :get (:static ("ä»»åŠ¡")))
          (:part :body  :get (:template-string "åˆ›å»º: %date\nçŠ¶æ€: å¾…å¼€å§‹\n"))))

        ;; å­¦ä¹ ç¬”è®°
        ("l" "å­¦ä¹ ç¬”è®°"
         :file "~/org/learning.org"
         :node-spec
         ((:part :title :get (:prompt "å­¦ä¹ ä¸»é¢˜: "))
          (:part :tags  :get (:prompt "æ ‡ç­¾: " :initial-input "å­¦ä¹ ,"))
          (:part :body  :get (:region-or-clipboard))
          (:part :fields :get (:static (((:tag "å­¦ä¹ " :field "éš¾åº¦" :get (:prompt "éš¾åº¦(1-5): "))
                                         (:tag "å­¦ä¹ " :field "æ¥æº" :get (:prompt "å­¦ä¹ æ¥æº: "))))))))

        ;; ä¼šè®®è®°å½•
        ("m" "ä¼šè®®è®°å½•"
         :file "~/org/meetings.org"
         :node-spec
         ((:part :title :get (:prompt "ä¼šè®®ä¸»é¢˜: "))
          (:part :tags  :get (:static ("ä¼šè®®")))
          (:part :body  :get (:template-string "æ—¶é—´: %date\nå‚ä¸è€…: \n\nè®®ç¨‹:\n\nè®¨è®ºè¦ç‚¹:\n\nè¡ŒåŠ¨é¡¹:\n"))
          (:part :fields :get (:static (((:tag "ä¼šè®®" :field "ç±»å‹" :get (:prompt "ä¼šè®®ç±»å‹: "))
                                         (:tag "ä¼šè®®" :field "çŠ¶æ€" :value "å·²å®Œæˆ")))))))))
```

### è‡ªå®šä¹‰å†…å®¹ç”Ÿæˆå™¨

åˆ›å»ºè‡ªå·±çš„å†…å®¹ç”Ÿæˆå™¨ä»¥æ»¡è¶³ç‰¹å®šéœ€æ±‚ï¼š

```elisp
(defun my-custom-generator ()
  "è‡ªå®šä¹‰å†…å®¹ç”Ÿæˆå™¨ç¤ºä¾‹"
  (format "é¡¹ç›®ç¼–å·: PRJ-%d\nåˆ›å»ºè€…: %s\n"
          (random 10000)
          (user-full-name)))

;; åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨:
(:part :body :get (:function my-custom-generator))
```

### æ‰©å±•æ¨¡æ¿å˜é‡

å¯ä»¥æ‰©å±•æ¨¡æ¿å­—ç¬¦ä¸²å¤„ç†å™¨æ¥æ”¯æŒæ›´å¤šå ä½ç¬¦ï¼š

```elisp
;; æ·»åŠ  %time å ä½ç¬¦æ”¯æŒ
(setq template (replace-regexp-in-string "%time" (format-time-string "%H:%M") template t t))
```

## ğŸ“š API å‚è€ƒ

### ç”¨æˆ·å‘½ä»¤

| å‘½ä»¤                             | æè¿°                       | ä½¿ç”¨æ–¹å¼                                       |
| -------------------------------- | -------------------------- | ---------------------------------------------- |
| `supertag-capture`               | ç‹¬ç«‹çš„æ•è·å‘½ä»¤             | `M-x supertag-capture`                         |
| `supertag-capture-with-template` | åŸºäºæ¨¡æ¿çš„æ•è·å‘½ä»¤         | `M-x supertag-capture-with-template`           |
| `supertag-capture-enrich-node`   | äº¤äº’å¼ä¸°å¯ŒèŠ‚ç‚¹å­—æ®µå€¼       | `M-x supertag-capture-enrich-node RET node-id` |

### ä¸ org-capture çš„é›†æˆï¼ˆå¯é€‰ï¼‰

Org-Supertag å¯ä»¥ä½œä¸º `org-capture` çš„ä¸€ä¸ªâ€œåå¤„ç†å±‚â€ï¼š  
ç»§ç»­ä½¿ç”¨ä½ åŸæœ¬çš„ `org-capture-templates`ï¼Œåªåœ¨ capture å®Œæˆåï¼Œç”± Supertag è´Ÿè´£ï¼š

- ç¡®ä¿èŠ‚ç‚¹æœ‰ç¨³å®šçš„ `ID`
- åŒæ­¥åˆ° Supertag æ•°æ®åº“
- å†™å…¥å­—æ®µï¼ˆTag/Field/Value æ¨¡å‹ï¼‰

#### å¯ç”¨é›†æˆ

```elisp
;; å…¨å±€å¯ç”¨ org-capture é›†æˆ
(setq supertag-org-capture-auto-enable t)
;; æˆ–äº¤äº’å¼è°ƒç”¨ï¼š
;; M-x supertag-enable-org-capture-integration
```

è¿™ä¼šåœ¨ `org-capture-after-finalize-hook` ä¸Šæ³¨å†Œä¸€ä¸ªé’©å­ï¼Œ  
åªå¯¹æ˜¾å¼æ ‡è®°äº† `:supertag t` çš„æ¨¡æ¿ç”Ÿæ•ˆã€‚

#### åœ¨ org-capture æ¨¡æ¿ä¸­å¼€å¯ Supertag æ”¯æŒ

åœ¨æ¨¡æ¿ plist ä¸­åŠ å…¥ `:supertag t` å³å¯è®©è¿™ä¸ªæ¨¡æ¿çš„ç»“æœå˜æˆ Supertag èŠ‚ç‚¹ï¼š  
å¯é€‰çš„ `:supertag-template` ç”¨äºåœ¨æ•è·åè‡ªåŠ¨å†™å…¥å­—æ®µï¼š

```elisp
(add-to-list 'org-capture-templates
             '("t" "å¸¦ Supertag çš„ä»»åŠ¡" entry
               (file+headline "~/org/tasks.org" "Inbox")
               "* TODO %^{ä»»åŠ¡}  #task\n  %?\n"
               :supertag t
               :supertag-template ((:tag "task" :field "status" :value "todo"))))
```

å®Œæˆåï¼ŒSupertag ä¼šï¼š

- ç¡®ä¿èŠ‚ç‚¹æœ‰ç¨³å®š `ID`
- åŒæ­¥åˆ° Supertag æ•°æ®åº“
- æ ¹æ® `:supertag-template` å†™å…¥å­—æ®µ

#### æŠŠ org-capture å’Œ `supertag-move-node` ç»“åˆèµ·æ¥

ä½ å¯ä»¥å¤åˆ»â€œorg-capture + org-refileâ€çš„ä¹ æƒ¯å·¥ä½œæµï¼š  
å…ˆç”¨ org-capture åˆ›å»ºèŠ‚ç‚¹ï¼Œç„¶åç”¨ Supertag çš„ç§»åŠ¨å‘½ä»¤æŠŠèŠ‚ç‚¹æ”¾åˆ°çœŸæ­£ä½ç½®ã€‚

åœ¨æ¨¡æ¿é‡Œæ·»åŠ  `:supertag-move`ï¼Œå³å¯åœ¨ capture å®Œæˆåè‡ªåŠ¨è°ƒç”¨ç§»åŠ¨å‘½ä»¤ï¼š

```elisp
(add-to-list 'org-capture-templates
             '("m" "ä»»åŠ¡ï¼ˆSupertag + ç§»åŠ¨ï¼‰" entry
               (file "~/org/inbox.org")
               "* TODO %^{ä»»åŠ¡}  #task\n  %?\n"
               :supertag t
               :supertag-move t))      ;; ä½¿ç”¨ supertag-move-node

(add-to-list 'org-capture-templates
             '("l" "ä»»åŠ¡ï¼ˆSupertag + ç§»åŠ¨å¹¶ç•™é“¾æ¥ï¼‰" entry
               (file "~/org/inbox.org")
               "* %^{æ ‡é¢˜}  #task\n  %?\n"
               :supertag t
               :supertag-move 'link))  ;; ä½¿ç”¨ supertag-move-node-and-link
```

- `:supertag-move t` æˆ– `:supertag-move 'node`  
  â†’ capture ç»“æŸåè°ƒç”¨ `supertag-move-node`ï¼Œå¼¹å‡ºâ€œç›®æ ‡æ–‡ä»¶ + æ’å…¥ä½ç½®â€çš„äº¤äº’ã€‚  
- `:supertag-move 'link` æˆ– `:supertag-move :link`  
  â†’ capture ç»“æŸåè°ƒç”¨ `supertag-move-node-and-link`ï¼ŒæŠŠèŠ‚ç‚¹ç§»èµ°å¹¶åœ¨åŸå¤„ç•™ä¸‹æŒ‡å‘è¯¥èŠ‚ç‚¹çš„é“¾æ¥ã€‚

è¿™ç­‰ä»·äºç»å…¸çš„â€œorg-capture + org-refileâ€ä¸¤æ­¥æµï¼Œä½†ç¬¬äºŒæ­¥ç”± Supertag çš„ç§»åŠ¨ API å®Œæˆï¼Œå¹¶è‡ªåŠ¨æ›´æ–°æ•°æ®åº“ä¸­çš„ä½ç½®ä¿¡æ¯ã€‚

#### åœ¨ org-capture è¿‡ç¨‹ä¸­äº¤äº’å¼é€‰æ‹© Supertag æ ‡ç­¾

å¦‚æœä½ å¸Œæœ›åœ¨ capture å®Œæˆåç«‹åˆ»ç”¨ Supertag çš„æ ‡ç­¾è¡¥å…¨ç•Œé¢æ¥é€‰æ‹©æ ‡ç­¾ï¼Œå¯ä»¥åœ¨æ¨¡æ¿ä¸­æ·»åŠ  `:supertag-tags-prompt t`ï¼š

```elisp
(add-to-list 'org-capture-templates
             '("s" "å¸¦æ ‡ç­¾é€‰æ‹©çš„ Supertag ä»»åŠ¡" entry
               (file "~/org/inbox.org")
               "* TODO %^{ä»»åŠ¡}\n  %?\n"
               :supertag t
               :supertag-tags-prompt t))
```

æ­£ç¡®ä½¿ç”¨æ­¥éª¤ï¼š

1. å…ˆå¯ç”¨ org-capture é›†æˆï¼Œä¾‹å¦‚ï¼š
   ```elisp
   (setq supertag-org-capture-auto-enable t)
   ;; æˆ–ï¼š (supertag-enable-org-capture-integration)
   ```
2. ä½¿ç”¨ä¸Šé¢çš„æ¨¡æ¿æ‰§è¡Œ org-captureï¼Œorg-capture æŒ‰æ¨¡æ¿æ’å…¥æ ‡é¢˜å’Œå†…å®¹
3. Supertag å¯¹è¯¥æ ‡é¢˜åšâ€œæœ€ç»ˆå®šç¨¿â€ï¼šç¡®ä¿ IDã€åŒæ­¥æ•°æ®åº“
4. éšåå¼¹å‡ºä¸€ä¸ªæç¤ºï¼š`Supertag tags (comma separated):`
5. ä½ å¯ä»¥ï¼š
   - ä»ç°æœ‰çš„ Supertag æ ‡ç­¾ä¸­é€‰æ‹©ï¼ˆæ”¯æŒè¡¥å…¨ã€å¤šé€‰ï¼‰ï¼Œæˆ–
   - ç›´æ¥è¾“å…¥æ–°çš„æ ‡ç­¾åç§°ï¼›ä¸å­˜åœ¨çš„æ ‡ç­¾ä¼šè‡ªåŠ¨åˆ›å»ºä¸ºæ­£å¼ Supertag æ ‡ç­¾
6. Supertag åŒæ—¶æ›´æ–°æ•°æ®åº“ä¸­çš„æ ‡ç­¾é›†ï¼Œå¹¶åœ¨æ ‡é¢˜ä¸­è¿½åŠ å¯¹åº”çš„ `#tag`

### å†…å®¹ç”Ÿæˆå™¨å‡½æ•°

| å‡½æ•°                                                | æè¿°                 |
| --------------------------------------------------- | -------------------- |
| `supertag-capture--get-from-static (args)`          | é™æ€å€¼ç”Ÿæˆå™¨         |
| `supertag-capture--get-from-prompt (args)`          | äº¤äº’æç¤ºç”Ÿæˆå™¨       |
| `supertag-capture--get-from-clipboard ()`           | å‰ªè´´æ¿å†…å®¹ç”Ÿæˆå™¨     |
| `supertag-capture--get-from-region ()`              | é€‰åŒºå†…å®¹ç”Ÿæˆå™¨       |
| `supertag-capture--get-from-region-or-clipboard ()` | é€‰åŒºæˆ–å‰ªè´´æ¿ç”Ÿæˆå™¨   |
| `supertag-capture--get-from-template-string (args)` | æ¨¡æ¿å­—ç¬¦ä¸²å¤„ç†å™¨     |
| `supertag-capture--get-from-function (args)`        | è‡ªå®šä¹‰å‡½æ•°è°ƒç”¨ç”Ÿæˆå™¨ |

## ğŸ†š ä¸ Org-Capture çš„å¯¹æ¯”

| ç‰¹æ€§         | Org-Capture            | Supertag æ•è· / é›†æˆå±‚         |
| ------------ | ---------------------- | ------------------------------- |
| æ¨¡æ¿é…ç½®     | é™æ€å­—ç¬¦ä¸²æ¨¡æ¿         | åŠ¨æ€å†…å®¹ç”Ÿæˆå™¨ + node-spec DSL |
| æ ‡ç­¾æ”¯æŒ     | æ‰‹åŠ¨è¾“å…¥               | äº¤äº’é€‰æ‹© + è‡ªåŠ¨å®Œæˆ             |
| å­—æ®µç®¡ç†     | å±æ€§æŠ½å±‰               | æ•°æ®åº“å­—æ®µç³»ç»Ÿ                 |
| å†…å®¹æ¥æº     | å›ºå®šæ ¼å¼               | å¤šç§ç”Ÿæˆå™¨                     |
| æ‰©å±•æ–¹å¼     | æœ‰é™                   | é«˜åº¦å¯æ‰©å±•                     |
| é›†æˆæ–¹å¼     | N/A                    | é€šè¿‡ hook åšåå¤„ç†             |

## ğŸ› æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

**é—®é¢˜**: æ¨¡æ¿æ‰§è¡Œæ—¶æŠ¥é”™ "Template doesn't exist"
**è§£å†³**: æ£€æŸ¥ `supertag-capture-templates` é…ç½®å’Œæ¨¡æ¿é”®å

**é—®é¢˜**: å­—æ®µè®¾ç½®å¤±è´¥
**è§£å†³**: ç¡®ä¿æ ‡ç­¾å­˜åœ¨ä¸”å®šä¹‰äº†ç›¸åº”å­—æ®µ

**é—®é¢˜**: æ–‡ä»¶å†™å…¥ä½ç½®é”™è¯¯
**è§£å†³**: æ£€æŸ¥ç›®æ ‡æ–‡ä»¶æ˜¯å¦å­˜åœ¨ä¸”å¯å†™

### è°ƒè¯•æŠ€å·§

1. ä½¿ç”¨ `M-x supertag-capture` æµ‹è¯•åŸºæœ¬åŠŸèƒ½
2. æ£€æŸ¥ `*Messages*` ç¼“å†²åŒºçš„é”™è¯¯ä¿¡æ¯
3. éªŒè¯æ¨¡æ¿é…ç½®çš„è¯­æ³•æ­£ç¡®æ€§
4. ç¡®è®¤æ‰€æœ‰ä¾èµ–çš„æ–‡ä»¶å’Œæ ‡ç­¾å­˜åœ¨

## ğŸ§© å¼€å‘è€…è¯´æ˜ï¼šæ ¸å¿ƒæ•è· API

å¦‚æœä½ å¸Œæœ›ç¼–å†™è‡ªå·±çš„å‰ç«¯ï¼ˆä¾‹å¦‚ä»å…¶å®ƒå‘½ä»¤é‡Œåˆ›å»ºèŠ‚ç‚¹ï¼‰ï¼Œå¯ä»¥ç›´æ¥è°ƒç”¨åº•å±‚çš„â€œæœ€ç»ˆå®šç¨¿â€ APIï¼Œå°†å½“å‰ Org æ ‡é¢˜è½¬ä¸º Supertag èŠ‚ç‚¹ï¼š

```elisp
;; åœ¨ä½ å¸Œæœ›å˜æˆ Supertag èŠ‚ç‚¹çš„æ ‡é¢˜ä¸Šè°ƒç”¨ï¼š
(supertag-capture-finalize-node-at-point
 '((:tag "task" :field "status" :value "todo")
   (:tag "task" :field "priority" :value "high")))
```

è¿™ä¼šï¼š

- ç¡®ä¿è¯¥æ ‡é¢˜æœ‰ç¨³å®šçš„ `ID`ï¼ˆå¿…è¦æ—¶è‡ªåŠ¨åˆ›å»ºï¼‰
- ä½¿ç”¨ `org-id` æ³¨å†Œ ID ä¸æ–‡ä»¶è·¯å¾„çš„æ˜ å°„
- åŒæ­¥èŠ‚ç‚¹åˆ° Supertag æ•°æ®åº“
- æŒ‰ç»™å®šçš„ Tag/Field/Value è§„æ ¼è°ƒç”¨ `supertag-field-set-many` å†™å…¥å­—æ®µ

org-capture é›†æˆå’Œ `supertag-capture-with-template` å†…éƒ¨éƒ½ä½¿ç”¨äº†è¿™ä¸ªå‡½æ•°ã€‚  
åœ¨æ„å»ºæ–°çš„æ•è·æµç¨‹æ—¶ï¼Œæ¨èå¤ç”¨è¯¥ APIï¼Œè€Œä¸æ˜¯é‡å¤å®ç°åŒæ­¥é€»è¾‘ã€‚

---

_æœ¬æ–‡æ¡£æè¿°äº† Org-Supertag v2.0 æ•è·ç³»ç»Ÿçš„å®Œæ•´åŠŸèƒ½å’Œä½¿ç”¨æ–¹æ³•ã€‚_
